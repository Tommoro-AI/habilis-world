# 데이터 수집

## 4. 데이터 수집

준비된 로봇과 설정된 포즈를 바탕으로 ROS2 Bag 형식의 원본 데이터를 수집하고 저장하는 단계입니다. 

---

### 4.1 사전 점검

데이터 수집을 시작하기 전, 다음 항목들을 반드시 확인합니다.

- **카메라 뷰 확인:** **Record** 메뉴에 접속하여 정면(Front) 및 측면(Side) 카메라 피드가 화면에 정상적으로 출력되는지 확인합니다.
    
    [이미지]
    

> **💡 [ 중요 ] 영상이 안나올 경우**
> 
> - **영상 하단 캡션과 영상이 안나오는 경우**
>     - robot-manager 확장팩 실행 여부 확인
>     - dataset-manager 확장팩 실행 여부 확인 + IP 주소를 올바르게 작성했는지 확인합니다.
>     
>     [이미지]
>     
> - **영상 하단 캡션은 나오지만 영상이 나오지 않는 경우**
>     - Config 페이지에서 디바이스를 재등록합니다.

---

### 4.2 메타데이터 설정

1. **Task Information** 섹션에 현재 수행 중인 작업의 메타데이터를 작성합니다.
    - `Task Name`: 수행할 작업의 이름을 입력합니다.
        > *중요: 입력한 이름은 생성될 **Lerobot 데이터셋의 폴더 이름**으로 사용됩니다.*
    - `Tags`: 각 에피소드의 특성이나 내용을 구분하기 위한 태그를 입력합니다. (선택 사항)
    - `Episode duration`: 하나의 에피소드가 녹화될 **최대 시간(초)**을 설정합니다.
    - `Task Instruction`: 로봇이 수행해야 할 구체적인 작업 지시문을 입력합니다.
    

[이미지]

> **🛠 [ 선택 ] 메타데이터 고정 및 자동 완성**
> : 동일한 메타데이터 저장, 로드, 삭제 기능을 합니다.
> 
> - **설정 삭제**: Load Preference 창에서 파일 목록을 선택 후 Delete 버튼을 클릭하여 삭제합니다.
>     
>     [이미지]
>     
> - **설정 불러오기**: Load Preference 창에서 **Load** 버튼을 클릭하면, 저장되었던 메타데이터가 로드됩니다.
>     
>     [이미지]
>     
> - **설정 저장**: 메타데이터 작성 후 **Save Preference** 창에서 **Save** 버튼을 눌러 저장합니다.
>     
>     [이미지]

---

### 4.3 초기 자세 이동

1. 상단 포즈 토글에서 원하는 로봇 자세 프리셋을 선택합니다
    
    [이미지]
    
2. 우측 초록색 **신발 모양 아이콘**을 클릭하여 로봇의 자세를 변경합니다.
    
    [이미지]
    

### 4.4 데이터 기록

1. 화면 하단의 **빨간색 녹화 버튼**을 클릭하여 데이터 기록을 시작합니다.
    
    [이미지]
    

> **⚠️ [ 주의 ] 데이터 누락 주의**
> 
> - 카메라 연결이 불안정 및 **데이터셋 기록 시 해당 에피소드가 자동으로 삭제**될 수 있습니다.
> - 온전한 데이터 확보를 위해 녹화 중 화면이 정상적으로 나오는지 확인해 주세요.

1. 삭제 아이콘을 눌러서 기록 도중에 취소할 수 있습니다.
    
    [이미지]
    
2. 저장된 원본 데이터는 `/habilis_dataset_manager/data/raw/{folder_name}`에 저장됩니다. 
- 원본 데이터 폴더 구조는 다음과 같습니다.

```bash
habilis_dataset_manager/data/                                                                                                
  └── raw/                                                                                                                 
      └── {YYYYMMDD_HHMMSS}/          # 녹화 시작 시간 타임스탬프                                                          
          ├── metadata.yaml            # ros2 bag이 자동 생성                                                              
          ├── *.mcap                   # ros2 bag 데이터 파일                                                
          └── metacard.json            # meta data                                                              
```

> **⚠️ [ 주의 ] ROS2 Bag 저장 실패**
> 
> - 다음의 경우엔 저장이 실패하거나 손상될 수 있으니, 사전에 점검해주세요.
>     - 통신 대역폭이 낮은 경우
>     - 디바이스 저장 공간이 부족한 경우